# 表单系统全面测试指南

## 🎯 测试目标

对 `@admin-core/layouts` 表单系统进行全面的手动功能测试，确保所有功能在实际使用场景中正常工作。

## 📋 准备工作

### 1. 启动开发服务器

```bash
# 在项目根目录
pnpm --filter @admin-core/layouts-demo dev
```

服务器将在 http://localhost:3001/ 启动

### 2. 打开浏览器

推荐使用 Chrome 浏览器进行测试，同时准备好：
- 浏览器开发者工具（F12）
- 控制台（Console）标签页
- 元素（Elements）标签页

### 3. 准备测试报告

打开 `MANUAL_TEST_REPORT.md` 文件，准备记录测试结果。

## 🧪 测试流程

### 阶段 1: 基础表单功能测试（15分钟）

**目标**: 验证表单的基本输入、提交、重置功能

**步骤**:

1. **打开基础表单标签页**
   - 点击顶部导航的"基础表单"标签
   - 观察页面是否正确加载

2. **测试字段渲染**
   - 检查是否显示 4 个字段：用户名、邮箱、手机号、个人简介
   - 检查每个字段的标签、占位符、帮助文本是否正确显示
   - 检查字段布局是否美观

3. **测试字段输入**
   - 在用户名字段输入 "testuser"
   - 在邮箱字段输入 "test@example.com"
   - 在手机号字段输入 "13800138000"
   - 在个人简介字段输入 "这是一个测试简介"
   - 验证输入的值正确显示在字段中

4. **测试表单提交**
   - 点击"提交"按钮
   - 观察是否显示绿色的成功提示框
   - 检查提示框中是否显示提交的数据（JSON 格式）
   - 打开浏览器控制台，检查是否输出 "表单提交:" 日志

5. **测试表单重置**
   - 再次填写所有字段
   - 点击"重置"按钮
   - 验证所有字段值被清空
   - 验证成功提示框消失
   - 检查控制台是否输出 "表单重置" 日志

6. **测试 API 方法**
   - 点击"设置用户名"按钮
     - 验证用户名字段自动填充为 "testuser"
   - 点击"获取所有值"按钮
     - 打开控制台，检查是否输出当前所有字段的值
   - 点击"重置表单"按钮
     - 验证表单被重置
   - 点击"触发验证"按钮
     - 如果有空字段，验证是否显示验证错误

**预期结果**: 所有操作都应该正常工作，没有错误提示

**记录**: 在 `MANUAL_TEST_REPORT.md` 的"1. 基础表单功能测试"部分记录结果

---

### 阶段 2: 表单验证功能测试（20分钟）

**目标**: 验证各种验证规则和错误提示

**步骤**:

1. **打开表单验证标签页**
   - 点击顶部导航的"表单验证"标签

2. **测试必填验证**
   - 不填写"必填字段"
   - 点击提交按钮
   - 验证字段下方显示红色错误提示："此字段为必填项"

3. **测试最小长度验证**
   - 在"最小长度"字段输入 "abc"（3个字符）
   - 失焦或点击提交
   - 验证显示错误："至少需要5个字符"
   - 输入 "abcde"（5个字符）
   - 验证错误消失

4. **测试最大长度验证**
   - 在"最大长度"字段输入 "12345678901"（11个字符）
   - 验证显示错误："最多10个字符"
   - 删除一个字符（变成10个字符）
   - 验证错误消失

5. **测试正则表达式验证**
   - 在"正则验证"字段输入 "hello"（小写开头）
   - 验证显示错误："必须以大写字母开头，后跟小写字母"
   - 输入 "Hello"（大写开头）
   - 验证错误消失

6. **测试数字范围验证**
   - 在"数字验证"字段输入 "-1"
   - 验证显示错误："不能小于0"
   - 输入 "101"
   - 验证显示错误："不能大于100"
   - 输入 "50"
   - 验证错误消失

7. **测试 URL 验证**
   - 在"URL验证"字段输入 "not-a-url"
   - 验证显示错误："请输入有效的URL"
   - 输入 "https://example.com"
   - 验证错误消失

8. **测试自定义验证**
   - 在"自定义验证"字段输入 "admin123"
   - 验证显示错误："不能包含 admin 关键字"
   - 输入 "user123"
   - 验证错误消失

9. **测试全部验证通过**
   - 正确填写所有字段
   - 点击提交
   - 验证显示 alert 提示："所有验证通过！"
   - 检查控制台输出提交的数据

**预期结果**: 所有验证规则都应该正确工作，错误提示清晰准确

**记录**: 在 `MANUAL_TEST_REPORT.md` 的"2. 表单验证功能测试"部分记录结果

---

### 阶段 3: 字段依赖功能测试（15分钟）

**目标**: 验证字段之间的联动关系

**步骤**:

1. **打开字段依赖标签页**
   - 点击顶部导航的"字段依赖"标签

2. **测试条件显示 (show)**
   - 观察初始状态，记录哪些字段可见
   - 切换触发字段的值
   - 验证依赖字段根据条件显示/隐藏
   - 注意：使用 CSS 隐藏，字段仍在 DOM 中

3. **测试条件渲染 (if)**
   - 切换触发字段的值
   - 打开浏览器开发者工具的 Elements 标签
   - 验证依赖字段根据条件在 DOM 中存在/不存在
   - 注意：字段会从 DOM 中完全移除

4. **测试动态禁用 (disabled)**
   - 切换触发字段的值
   - 验证依赖字段根据条件启用/禁用
   - 尝试在禁用状态下输入，验证无法输入
   - 验证禁用状态的视觉效果（灰色、不可点击）

5. **测试动态必填 (required)**
   - 切换触发字段的值
   - 观察依赖字段的必填标记（*）是否根据条件显示/隐藏
   - 提交表单，验证必填规则是否生效

6. **测试依赖传播**
   - 修改触发字段的值
   - 验证所有依赖该字段的字段都正确更新
   - 如果有多级依赖（A → B → C），验证传播是否正确

**预期结果**: 所有依赖关系都应该正确工作，联动及时准确

**记录**: 在 `MANUAL_TEST_REPORT.md` 的"3. 字段依赖功能测试"部分记录结果

---

### 阶段 4: 动态表单功能测试（15分钟）

**目标**: 验证运行时添加、删除、修改字段的功能

**步骤**:

1. **打开动态表单标签页**
   - 点击顶部导航的"动态表单"标签

2. **测试动态添加字段**
   - 点击"添加字段"按钮
   - 验证新字段出现在表单中
   - 在新字段中输入值
   - 再次点击"添加字段"按钮
   - 验证可以添加多个字段

3. **测试动态删除字段**
   - 添加 3-4 个字段
   - 点击某个字段的"删除"按钮
   - 验证该字段从表单中消失
   - 验证其他字段不受影响

4. **测试动态修改字段配置**
   - 点击某个字段的"禁用/启用"按钮
   - 验证字段的禁用状态正确切换
   - 尝试在禁用状态下输入，验证无法输入
   - 再次点击按钮，验证字段恢复可用

5. **测试动态表单提交**
   - 添加多个字段并填写值
   - 点击提交按钮
   - 验证所有动态字段的值都包含在提交数据中
   - 检查控制台输出

6. **测试删除字段后提交**
   - 添加字段并填写值
   - 删除某些字段
   - 提交表单
   - 验证已删除字段的值不包含在提交数据中

**预期结果**: 动态操作都应该正常工作，表单状态正确更新

**记录**: 在 `MANUAL_TEST_REPORT.md` 的"4. 动态表单功能测试"部分记录结果

---

### 阶段 5: 布局模式功能测试（20分钟）

**目标**: 验证不同布局模式的显示效果

**步骤**:

1. **打开布局模式标签页**
   - 点击顶部导航的"布局模式"标签

2. **测试水平布局**
   - 查看水平布局示例
   - 验证标签在左侧，控件在右侧
   - 验证标签和控件对齐整齐
   - 验证布局美观

3. **测试垂直布局**
   - 查看垂直布局示例
   - 验证标签在上方，控件在下方
   - 验证布局清晰易读

4. **测试内联布局**
   - 查看内联布局示例
   - 验证字段横向排列在一行
   - 验证布局紧凑

5. **测试栅格布局**
   - 查看 2 列栅格布局示例
   - 验证字段分成 2 列显示
   - 查看 3 列栅格布局示例
   - 验证字段分成 3 列显示

6. **测试紧凑模式**
   - 查看紧凑模式示例
   - 验证字段之间的间距更小
   - 验证没有为验证信息预留的空白空间

7. **测试响应式布局**
   - 调整浏览器窗口宽度到不同尺寸：
     - 移动端（< 640px）
     - 平板（640px - 1024px）
     - 桌面（> 1024px）
   - 验证布局在不同尺寸下正确适配
   - 验证字段在小屏幕上堆叠显示
   - 验证字段在大屏幕上并排显示

**预期结果**: 所有布局模式都应该正确显示，响应式适配良好

**记录**: 在 `MANUAL_TEST_REPORT.md` 的"5. 布局模式功能测试"部分记录结果

---

### 阶段 6: 高级功能测试（15分钟）

**目标**: 验证折叠展开、自定义渲染等高级功能

**步骤**:

1. **打开高级功能标签页**
   - 点击顶部导航的"高级功能"标签

2. **测试折叠展开功能**
   - 观察初始状态（展开）
   - 点击"折叠"按钮
   - 验证表单折叠，只显示部分字段（根据 collapsedRows 配置）
   - 观察折叠动画是否流畅
   - 点击"展开"按钮
   - 验证表单展开，显示所有字段
   - 观察展开动画是否流畅

3. **测试自定义渲染**
   - 查看带后缀的字段
   - 验证后缀内容（如单位、图标）正确显示在字段右侧
   - 查看带描述的字段
   - 验证描述文本显示在字段下方
   - 查看带帮助提示的字段
   - 验证帮助图标（?）显示在标签旁边
   - 悬停在帮助图标上，验证是否显示提示信息

4. **测试 API 操作**
   - 点击"设置所有值"按钮
   - 验证所有字段值被批量设置
   - 点击"获取所有值"按钮
   - 检查控制台输出所有字段的值
   - 点击"设置单个字段"按钮
   - 验证指定字段的值被设置
   - 点击"验证字段"按钮
   - 验证指定字段的验证被触发
   - 点击"重置表单"按钮
   - 验证表单被重置到初始状态

**预期结果**: 所有高级功能都应该正常工作，用户体验良好

**记录**: 在 `MANUAL_TEST_REPORT.md` 的"6. 高级功能测试"部分记录结果

---

### 阶段 7: 简单示例测试（5分钟）

**目标**: 验证简化版示例是否正常工作

**步骤**:

1. **打开简单示例标签页**
   - 点击顶部导航的"简单示例"标签

2. **测试简单表单**
   - 填写表单字段
   - 提交表单
   - 验证功能正常

**预期结果**: 简单示例应该正常工作

**记录**: 在 `MANUAL_TEST_REPORT.md` 的"7. 简单示例测试"部分记录结果

---

## 📊 测试报告

### 完成测试后

1. **填写测试报告**
   - 打开 `MANUAL_TEST_REPORT.md`
   - 填写所有测试项的结果（通过/失败）
   - 记录发现的问题和备注
   - 计算通过率

2. **记录问题**
   - 对于失败的测试项，详细描述问题
   - 如果可能，截图保存问题现场
   - 记录复现步骤

3. **性能观察**
   - 记录页面加载时间
   - 记录交互响应时间
   - 注意是否有明显的性能问题

4. **浏览器兼容性**
   - 如果有条件，在不同浏览器中测试
   - 记录每个浏览器的测试结果

## 🎯 测试重点

### 必须通过的关键功能

1. ✅ 表单提交和重置
2. ✅ 字段值设置和获取
3. ✅ 基础验证功能（必填、长度、格式）
4. ✅ 字段依赖联动
5. ✅ 动态添加/删除字段

### 重要但非关键的功能

1. 🔸 高级验证规则
2. 🔸 自定义渲染
3. 🔸 折叠展开
4. 🔸 响应式布局

## 🐛 常见问题排查

### 如果表单无法提交

1. 检查浏览器控制台是否有错误
2. 检查是否有验证错误
3. 检查 handleSubmit 回调是否正确配置

### 如果字段依赖不工作

1. 检查依赖配置是否正确
2. 检查触发字段的值是否正确
3. 检查浏览器控制台是否有错误

### 如果动态表单有问题

1. 检查 schema 更新是否正确
2. 检查字段名是否唯一
3. 检查浏览器控制台是否有错误

## 📝 测试技巧

1. **使用浏览器开发者工具**
   - Console 标签查看日志和错误
   - Elements 标签检查 DOM 结构
   - Network 标签检查网络请求

2. **测试边界情况**
   - 空值、null、undefined
   - 超长字符串
   - 特殊字符
   - 极大/极小数字

3. **测试用户操作**
   - 快速连续点击
   - 复制粘贴
   - 键盘导航（Tab 键）
   - 回车提交

4. **记录详细信息**
   - 截图保存问题现场
   - 记录复现步骤
   - 记录浏览器版本和操作系统

## ✅ 测试完成标准

- [ ] 所有 32 个测试项都已执行
- [ ] 测试报告已完整填写
- [ ] 发现的问题已详细记录
- [ ] 通过率已计算
- [ ] 测试结论已填写

---

**祝测试顺利！** 🎉

如果遇到问题，请查看：
- `TESTING_GUIDE.md` - 详细测试指南
- `README.md` - 项目说明
- `TROUBLESHOOTING.md` - 问题排查指南
